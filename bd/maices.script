CREATE SCHEMA PUBLIC AUTHORIZATION DBA
CREATE TEXT TABLE CONFIGURACION(UID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,ID_SISTEMA VARCHAR(100) NOT NULL,FONDO_H_MIN FLOAT,FONDO_H_MAX FLOAT,FONDO_S_MIN FLOAT,FONDO_S_MAX FLOAT,FONDO_V_MIN FLOAT,FONDO_V_MAX FLOAT,DIAMETRO_OBJETO_REFERENCIA DOUBLE,CONSTRAINT UK_CONFIGURACION UNIQUE(ID_SISTEMA))
SET TABLE CONFIGURACION SOURCE "configuracion.txt"
CREATE TEXT TABLE RUBRO_CALIDAD(UID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,NOMBRE VARCHAR(100) NOT NULL,DESCRIPCION VARCHAR(256) NOT NULL,ID_SISTEMA VARCHAR(100) NOT NULL,CLASE_EVALUADOR_DESCUENTO VARCHAR(256),CLASE_EVALUADOR_VALOR_RUBRO VARCHAR(256),CONSTRAINT UK_RUBRO UNIQUE(ID_SISTEMA,NOMBRE))
SET TABLE RUBRO_CALIDAD SOURCE "rubro_calidad.txt"
CREATE TEXT TABLE CLASE(UID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,NOMBRE VARCHAR(100) NOT NULL,DESCRIPCION VARCHAR(256),COLOR_RGB INTEGER,ORDEN_EVALUACION INTEGER NOT NULL,ID_RUBRO INTEGER,INDETERMINADO BOOLEAN NOT NULL,OBJETO_REFERENCIA BOOLEAN NOT NULL,CANTIDAD_OBJETOS INTEGER DEFAULT 0 NOT NULL,CONSTRAINT UK_CLASE UNIQUE(NOMBRE),CONSTRAINT FK_CLASE_RUBRO FOREIGN KEY(ID_RUBRO) REFERENCES RUBRO_CALIDAD(UID) ON UPDATE CASCADE)
SET TABLE CLASE SOURCE "clase.txt"
CREATE TEXT TABLE RASGO(UID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,NOMBRE VARCHAR(100) NOT NULL,DESCRIPCION VARCHAR(256),NOMBRE_EVALUADOR_RASGO VARCHAR(256),VISIBLE BOOLEAN NOT NULL,CONSTRAINT UK_RASGO UNIQUE(NOMBRE))
SET TABLE RASGO SOURCE "rasgo.txt"
CREATE TEXT TABLE RASGO_CLASE(UID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,ID_CLASE BIGINT NOT NULL,ID_RASGO BIGINT NOT NULL,SUM_VALOR DOUBLE,SUM_VALOR_CUADRADO DOUBLE,CANT_VALORES DOUBLE,MAXIMO DOUBLE,MAXIMO_REAL DOUBLE,MINIMO DOUBLE,MINIMO_REAL DOUBLE,PESO DOUBLE NOT NULL,CALCULAR_VALOR_MEDIO BOOLEAN NOT NULL,DETERMINANTE BOOLEAN NOT NULL,RANGO_VARIABLE BOOLEAN NOT NULL,INDICE BIGINT,CONSTRAINT UK_RASGO_CLASE UNIQUE(ID_CLASE,ID_RASGO),CONSTRAINT FK_RASGO_CLASE_CLASE FOREIGN KEY(ID_CLASE) REFERENCES CLASE(UID) ON UPDATE CASCADE,CONSTRAINT FK_RASGO_CLASE_RASGO FOREIGN KEY(ID_RASGO) REFERENCES RASGO(UID) ON UPDATE CASCADE)
SET TABLE RASGO_CLASE SOURCE "rasgo_clase.txt"
CREATE TEXT TABLE OBJETO(UID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,NOMBRE VARCHAR(256) NOT NULL)
SET TABLE OBJETO SOURCE "objeto.txt"
CREATE TEXT TABLE RASGO_OBJETO(UID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,ID_OBJETO BIGINT NOT NULL,ID_RASGO BIGINT NOT NULL,VALOR DOUBLE,ID_CLASE BIGINT,INDICE BIGINT,CONSTRAINT FK_RASGO_OBJETO FOREIGN KEY(ID_OBJETO) REFERENCES OBJETO(UID) ON UPDATE CASCADE,CONSTRAINT FK_RASGO_OBJETO_RASGO FOREIGN KEY(ID_RASGO) REFERENCES RASGO(UID) ON UPDATE CASCADE,CONSTRAINT FK_RASGO_OBJETO_CLASE FOREIGN KEY(ID_CLASE) REFERENCES CLASE(UID) ON UPDATE CASCADE)
SET TABLE RASGO_OBJETO SOURCE "rasgo_objeto.txt"
CREATE TEXT TABLE CLASE_OBJETO(UID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,ID_OBJETO BIGINT NOT NULL,ID_CLASE BIGINT NOT NULL,INDICE BIGINT,CONSTRAINT FK_CLASE_OBJETO FOREIGN KEY(ID_OBJETO) REFERENCES OBJETO(UID) ON UPDATE CASCADE,CONSTRAINT FK_CLASE_OBJETO_CLASE FOREIGN KEY(ID_CLASE) REFERENCES CLASE(UID) ON UPDATE CASCADE)
SET TABLE CLASE_OBJETO SOURCE "clase_objeto.txt"
CREATE TEXT TABLE HISTOGRAMA(UID BIGINT NOT NULL PRIMARY KEY,TIPO VARCHAR(50) NOT NULL,MAX_VALORES INTEGER NOT NULL,VALORES VARCHAR(1000))
SET TABLE HISTOGRAMA SOURCE "histograma.txt"
CREATE TEXT TABLE HISTOGRAMA_CLASE(ID_HISTOGRAMA BIGINT NOT NULL,ID_CLASE BIGINT NOT NULL,INDICE INTEGER,CONSTRAINT PK_HISTOGRAMA_CLASE PRIMARY KEY(ID_HISTOGRAMA,ID_CLASE),CONSTRAINT FK_HISTOGRAMA_CLASE_CLASE FOREIGN KEY(ID_CLASE) REFERENCES CLASE(UID) ON UPDATE CASCADE,CONSTRAINT FK_HISTOGRAMA_CLASE_HISTO FOREIGN KEY(ID_HISTOGRAMA) REFERENCES HISTOGRAMA(UID) ON UPDATE CASCADE)
SET TABLE HISTOGRAMA_CLASE SOURCE "histograma_clase.txt"
CREATE TEXT TABLE VALOR_HISTOGRAMA(UID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,ID_HISTOGRAMA BIGINT NOT NULL,VALOR DOUBLE NOT NULL,INDICE BIGINT NOT NULL,CONSTRAINT FK_VALOR_HISTO_HISTOGRAMA FOREIGN KEY(ID_HISTOGRAMA) REFERENCES HISTOGRAMA(UID) ON UPDATE CASCADE)
SET TABLE VALOR_HISTOGRAMA SOURCE "valor_histograma.txt"
CREATE TEXT TABLE GRADO(UID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,NOMBRE VARCHAR(256) NOT NULL,REBAJA DOUBLE NOT NULL,ES_FUERA_ESTANDAR BOOLEAN NOT NULL,ID_SISTEMA VARCHAR(100) NOT NULL)
SET TABLE GRADO SOURCE "grado.txt"
CREATE TEXT TABLE TOLERANCIA_RUBRO(UID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL PRIMARY KEY,ID_RUBRO INTEGER NOT NULL,ID_GRADO INTEGER NOT NULL,VALOR DOUBLE,DESCUENTO DOUBLE,CONSTRAINT FK_TOLE_RUBRO_RUBRO FOREIGN KEY(ID_RUBRO) REFERENCES RUBRO_CALIDAD(UID) ON UPDATE CASCADE,CONSTRAINT FK_TOLE_RUBRO_GRADO FOREIGN KEY(ID_GRADO) REFERENCES GRADO(UID) ON UPDATE CASCADE,CONSTRAINT UK_GRADO_RUBRO UNIQUE(ID_GRADO,ID_RUBRO))
SET TABLE TOLERANCIA_RUBRO SOURCE "tolerancia_rubro.txt"
ALTER TABLE CONFIGURACION ALTER COLUMN UID RESTART WITH 0
ALTER TABLE RUBRO_CALIDAD ALTER COLUMN UID RESTART WITH 0
ALTER TABLE CLASE ALTER COLUMN UID RESTART WITH 0
ALTER TABLE RASGO ALTER COLUMN UID RESTART WITH 0
ALTER TABLE RASGO_CLASE ALTER COLUMN UID RESTART WITH 0
ALTER TABLE OBJETO ALTER COLUMN UID RESTART WITH 0
ALTER TABLE RASGO_OBJETO ALTER COLUMN UID RESTART WITH 0
ALTER TABLE CLASE_OBJETO ALTER COLUMN UID RESTART WITH 0
ALTER TABLE VALOR_HISTOGRAMA ALTER COLUMN UID RESTART WITH 0
ALTER TABLE GRADO ALTER COLUMN UID RESTART WITH 0
ALTER TABLE TOLERANCIA_RUBRO ALTER COLUMN UID RESTART WITH 0
CREATE USER SA PASSWORD "SA"
GRANT DBA TO SA
SET WRITE_DELAY 20
